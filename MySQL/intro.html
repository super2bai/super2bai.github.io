<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="stylesheet" href="/style/style.css">
<script>
  var nlviconfig = {
    title: "贰白",
    author: "super2bai",
    baseUrl: "/",
    theme: {
      scheme: "banderole",
      lightbox: true,
      animate: true,
      search: true,
      friends: false,
      reward: true,
      lazy: false
    }
  }
</script>




    <link rel="stylesheet" href="/script/lib/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">




    <link rel="icon" href="https://wx4.sinaimg.cn/mw690/8c564d2agy1fq4rsiycy4j202c01wa9v.jpg">




<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98059014-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116557847-1');
</script>





    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="贰白">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />

  <link rel="apple-touch-icon"  sizes="72x72"  href="https://wx4.sinaimg.cn/mw690/8c564d2agy1fq4rsiycy4j202c01wa9v.jpg">
  <link rel="apple-touch-icon-precomposed"  sizes="72x72"  href="https://wx4.sinaimg.cn/mw690/8c564d2agy1fq4rsiycy4j202c01wa9v.jpg">


  <meta name="subtitle" content="苦于探索，全是未知">


  <meta name="description" content="苦于探索，全是未知">



  <meta name="keywords" content="MySQL, Nlvi" />

  <title> MySQL概述 · 贰白 </title>
</head>
<body>
  <div class="progress">
  <div class="progress-inner"></div>
</div>
  
  
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
  <div class="tagcloud-inner">
    <a href="/tags/Data-Structures/" style="font-size: 14px;">Data Structures</a> <a href="/tags/Docker/" style="font-size: 14px;">Docker</a> <a href="/tags/Dubbo/" style="font-size: 14px;">Dubbo</a> <a href="/tags/GHPages/" style="font-size: 14px;">GHPages</a> <a href="/tags/IO/" style="font-size: 14px;">IO</a> <a href="/tags/JDK/" style="font-size: 14px;">JDK</a> <a href="/tags/JVM/" style="font-size: 14px;">JVM</a> <a href="/tags/Linux/" style="font-size: 14px;">Linux</a> <a href="/tags/MyBatis/" style="font-size: 14px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 14px;">MySQL</a> <a href="/tags/Python/" style="font-size: 14px;">Python</a> <a href="/tags/Spring/" style="font-size: 14px;">Spring</a> <a href="/tags/Zookeeper/" style="font-size: 14px;">Zookeeper</a> <a href="/tags/book/" style="font-size: 14px;">book</a> <a href="/tags/code/" style="font-size: 14px;">code</a> <a href="/tags/es/" style="font-size: 14px;">es</a> <a href="/tags/git/" style="font-size: 14px;">git</a> <a href="/tags/github/" style="font-size: 14px;">github</a> <a href="/tags/idea/" style="font-size: 14px;">idea</a> <a href="/tags/jmeter/" style="font-size: 14px;">jmeter</a> <a href="/tags/mac/" style="font-size: 14px;">mac</a> <a href="/tags/monitor/" style="font-size: 14px;">monitor</a> <a href="/tags/server/" style="font-size: 14px;">server</a> <a href="/tags/walkup/" style="font-size: 14px;">walkup</a> <a href="/tags/分布式/" style="font-size: 14px;">分布式</a> <a href="/tags/工具/" style="font-size: 14px;">工具</a> <a href="/tags/并发/" style="font-size: 14px;">并发</a> <a href="/tags/旅游/" style="font-size: 14px;">旅游</a> <a href="/tags/汇编/" style="font-size: 14px;">汇编</a> <a href="/tags/监控/" style="font-size: 14px;">监控</a> <a href="/tags/编码/" style="font-size: 14px;">编码</a>
  </div>
</div>  
  

  <div class="container">

    <header class="header" id="header">
  <div class="header-wrapper">
    <div class="logo">
  <div class="logo-inner syuanpi tvIn">
    <span><a href="/">贰白</a></span>
    
      <span id="subtitle">苦于探索，全是未知</span>
    
  </div>
</div>
    <nav class="main-nav">
  
  <ul class="main-nav-list syuanpi tvIn">
  
    <li class="menu-item">
      <a href="javascript:;" id="search">
        <span>搜索</span>
        
          <span class="menu-item-label">search</span>
        
      </a>
    </li>
  
  
    
      
    
    <li class="menu-item">
      <a href="/" id="article">
        <span class="base-name">文章</span>
        
          <span class="menu-item-label">article</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="/archives" id="archives">
        <span class="base-name">归档</span>
        
          <span class="menu-item-label">archives</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="javascript:;" id="tags">
        <span class="base-name">标签</span>
        
          <span class="menu-item-label">tags</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="/about" id="about">
        <span class="base-name">关于</span>
        
          <span class="menu-item-label">about</span>
        
      </a>
    </li>
  
  </ul>
  
</nav>

    
    
  </div>
</header>
<div class="mobile-header">
  <div class="mobile-header-body">
    <div class="mobile-header-list">
      
        
            <div class="mobile-nav-item">
                <a href="/">
                    <span>文章</span>
                    
                        <span class="menu-item-label">article</span>
                    
                </a>
            </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/archives">
                    <span>归档</span>
                    
                        <span class="menu-item-label">archives</span>
                    
                </a>
            </div>
        
      
        
          <div class="mobile-nav-item inner-cloud">
            <div class="mobile-nav-tag">
              <a href="javascript:;" id="mobile-tags">
                <span>标签</span>
                
                    <span class="menu-item-label">tags</span>
                
              </a>
            </div>
            <div class="mobile-nav-tagcloud">
              <div class="mobile-tagcloud-inner">
                <a href="/tags/Data-Structures/" style="font-size: 14px;">Data Structures</a> <a href="/tags/Docker/" style="font-size: 14px;">Docker</a> <a href="/tags/Dubbo/" style="font-size: 14px;">Dubbo</a> <a href="/tags/GHPages/" style="font-size: 14px;">GHPages</a> <a href="/tags/IO/" style="font-size: 14px;">IO</a> <a href="/tags/JDK/" style="font-size: 14px;">JDK</a> <a href="/tags/JVM/" style="font-size: 14px;">JVM</a> <a href="/tags/Linux/" style="font-size: 14px;">Linux</a> <a href="/tags/MyBatis/" style="font-size: 14px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 14px;">MySQL</a> <a href="/tags/Python/" style="font-size: 14px;">Python</a> <a href="/tags/Spring/" style="font-size: 14px;">Spring</a> <a href="/tags/Zookeeper/" style="font-size: 14px;">Zookeeper</a> <a href="/tags/book/" style="font-size: 14px;">book</a> <a href="/tags/code/" style="font-size: 14px;">code</a> <a href="/tags/es/" style="font-size: 14px;">es</a> <a href="/tags/git/" style="font-size: 14px;">git</a> <a href="/tags/github/" style="font-size: 14px;">github</a> <a href="/tags/idea/" style="font-size: 14px;">idea</a> <a href="/tags/jmeter/" style="font-size: 14px;">jmeter</a> <a href="/tags/mac/" style="font-size: 14px;">mac</a> <a href="/tags/monitor/" style="font-size: 14px;">monitor</a> <a href="/tags/server/" style="font-size: 14px;">server</a> <a href="/tags/walkup/" style="font-size: 14px;">walkup</a> <a href="/tags/分布式/" style="font-size: 14px;">分布式</a> <a href="/tags/工具/" style="font-size: 14px;">工具</a> <a href="/tags/并发/" style="font-size: 14px;">并发</a> <a href="/tags/旅游/" style="font-size: 14px;">旅游</a> <a href="/tags/汇编/" style="font-size: 14px;">汇编</a> <a href="/tags/监控/" style="font-size: 14px;">监控</a> <a href="/tags/编码/" style="font-size: 14px;">编码</a>
              </div>
            </div>
          </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/about">
                    <span>关于</span>
                    
                        <span class="menu-item-label">about</span>
                    
                </a>
            </div>
        
      
    </div>
  </div>
  <div class="mobile-header-nav">
    <div class="mobile-header-item" id="mobile-left">
      <div class="header-menu-item">
        <span class="header-menu-line"></span>
      </div>
    </div>
    <h1 class="mobile-header-title">
      <a href="/">贰白</a>
    </h1>
    <div class="mobile-header-item"></div>
  </div>
</div>
    <div class="container-inner">
      <main class="main" id="main">
        <div class="main-wrapper">
          
    
  
  <article class="
  post
   is_post 
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2019-08-10</span>
          
            
              <span class="post-category"><a href="/categories/MySQL/">MySQL</a></span>
            
          
          
            
              <aside class="post-tags syuanpi fadeInUpShort back-3">
              
                <a href="/tags/MySQL/">MySQL</a>
              
              </aside>
            
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          MySQL概述
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        <p>宏观来看</p>
<a id="more"></a>
<ul>
<li><a href="https://dev.mysql.com/downloads/mysql/8.0.html" target="_blank" rel="external">MySQL 8.0</a>采用GPL协议</li>
<li>单进程多线程</li>
<li>查看MySQL查找文件的顺序：<code>mysql --help | grep my.cnf</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> mysql --help | grep my.cnf</div><div class="line">                      order of preference, my.cnf, $MYSQL_TCP_PORT,</div><div class="line">/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf</div></pre></td></tr></table></figure>
<p>多个配置文件，以最后为准；缺失配置文件，按照编译时的默认参数设置。</p>
<ul>
<li>启动方式：<code>mysqld</code>、<code>mysqld_safe</code>、<code>mysqld_multi</code>(主要用于多实例启动)</li>
</ul>
<p>首先当使用<code>service mysqld start</code>或者<code>/etc/init.d/mysqld start</code>这样的方式启动的时候，其实是使用了<code>mysql.server</code>这个脚本，这个脚本默认会调用<code>mysqld_safe</code>来启动<code>mysqld</code>，所以通常我们启动mysql之后查看进程的时候会发现有<code>mysqld</code>和<code>mysqld_safe</code>这两个进程存在。这两种通常都是<strong>单实例</strong>的启动方式，当然也可以使用mysqld来启动多实例的。而<code>mysqld_multi</code>用来启动多实例，也是通过先调用<code>mysqld_safe</code>和<code>mysqld</code>来启动mysql的。参考：<a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-server.html" target="_blank" rel="external">MySQL Server</a></p>
<ul>
<li>启动原理：启动程序为<code>mysql.server</code>，用到的程序my_print_defaults、myslqd_safe和函数parse_server_arguments<ul>
<li>my_print_defaults:读取my.cnf配置文件，输出参数传递给parse_server_arguments，该程序只读my.cnf中[mysqld]中的参数。</li>
<li>parse_server_arguments：该函数处理my_print_defaults传递过来的参数赋值给–basedir、–datadir、–pid-file、–server-startup-timeout</li>
<li>myslqd_safe:mysqld_safe程序调用mysqld程序来启动mysql服务,[mysqld_safe]会覆盖mysqld部分中的参数</li>
<li>mysqld_multi会读取配置文件中的[mysqld_muti],[mysqldN]下面的参数，N需要时一个整数，建议用端口号表示，该部分的配置会覆盖[mysqld]部分中的配置</li>
<li>在mysqld进程挂掉的时候，mysqld_safe进程会监测到并重新将mysqld启动起来</li>
</ul>
</li>
</ul>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/programs-overview.html" target="_blank" rel="external">My SQL Programs Overview</a></p>
<ul>
<li>查看数据库存放路径：<code>show variables like &#39;%datadir%&#39;\G</code></li>
<li>数据库是由 一个个文件组成 （一般来说都是二进制的文件） 的，如果要对这些文件执行诸如 SELECT 、 INSERT 、UPDATE和DETELE 之类的操作 ，不能通过简单的操作文件来更改数据库的内容 ， 需要通过数据库实例来完成对数据库的操作 。</li>
</ul>
<h3 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h3><ul>
<li>架构<ul>
<li>连接池组件</li>
<li>管理服务和工具组件</li>
<li>SQL接口组件</li>
<li>查询分析器组件</li>
<li>优化器组件</li>
<li>缓冲（cache）组件</li>
<li>插件式存储引擎</li>
<li>物理文件</li>
</ul>
</li>
</ul>
<p><img src="https://3.bp.blogspot.com/-WllJC9xfxqg/VxTbuAoMm4I/AAAAAAAAHzA/1tF7Sxx8Y34levMmR9fYPZfDQDHVdWzKwCLcB/s1600/MySQL%2BArchitecture.png" alt=""></p>
<p>MySQL最重要的特点就是其插件式的表存储引擎，这是与其他数据库最重要的区别，它提供了一些列标准的管理和服务支持，这些标准与存储引擎无关，例如SQL分析器和优化器等。存储引擎是基于表的。MySQL的核心是存储引擎。</p>
<h3 id="InnoDB存储引擎"><a href="#InnoDB存储引擎" class="headerlink" title="InnoDB存储引擎"></a><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-introduction.html" target="_blank" rel="external">InnoDB存储引擎</a></h3><blockquote>
<p>完整支持ACID事务，主要面向在线事务处理(OLTP)方面的应用</p>
</blockquote>
<h4 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h4><p><a href="https://dev.mysql.com/doc/refman/5.6/en/innodb-architecture.html" target="_blank" rel="external">InnoDB Architecture</a></p>
<p><img src="https://dev.mysql.com/doc/refman/5.6/en/images/innodb-architecture.png" alt=""></p>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul>
<li>行锁设计</li>
<li>支持外键</li>
<li>支持非锁定读<ul>
<li>默认情况下读取操作不会产生锁</li>
</ul>
</li>
<li>InnoDB存储引擎将数据放在一个逻辑的表空间中，由InnoDB自身进行管理。从MySQL4.1版本开始，它可以将每个InnoDB存储引擎的表单独存放到一个独立的<code>ibd</code>文件中。</li>
<li>InnoDB通过使用多版本并发控制(MVCC)来获得高并发性，并实现了SQL标准的4种隔离级别，默认为<code>REPEATABLE</code>级别。同时使用一种被称为<code>next-key locking</code>的策略来避免幻读(phantom)现象的产生。</li>
<li>InnoDB引擎还提供了插入缓冲(insert buffer)、二次写(double write)、自适应哈希索引(adaptive hash index)、预读(read ahead)等高性能和高可用的功能。</li>
<li>表中数据的存储，采用聚集(clustered)的方式。每张表的存储都按主键的顺序存放，如果没有显式地在表定义时指定主键，InnoDB存储引擎会为每一行生成一个6字节的ROWID，并以此为主键。</li>
<li>最有效的利用内存和CPU</li>
</ul>
<h4 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-best-practices.html" target="_blank" rel="external">最佳实践</a></h4><ul>
<li>指定主键或自增的值</li>
<li>关闭自动提交</li>
<li>将一组相关的DML操作分组到事务中</li>
<li>不使用LOCK TABLES语句<ul>
<li>InnoDB可以同时处理多个会话，同时读取和写入同一个表，而不会牺牲可靠性或高性能。要获得对一组行的独占写访问权，请使用SELECT … FOR UPDATE语法仅锁定要更新的行。</li>
</ul>
</li>
<li>启用innodb_file_per_table选项或使用通用表空间将表的数据和索引放入单独的文件中，而不是系统表空间。</li>
<li>在不牺牲读/写功能的情况下压缩InnoDB表</li>
<li>使用选项–sql_mode = NO_ENGINE_SUBSTITUTION运行服务器，以防止在CREATE TABLE的ENGINE =子句中指定的引擎出现问题时使用其他存储引擎创建表。</li>
</ul>
<h3 id="架构模型"><a href="#架构模型" class="headerlink" title="架构模型"></a>架构模型</h3><p><img src="https://www.oreilly.com/library/view/high-performance-mysql/9780596101718/httpatomoreillycomsourceoreillyimages206364.png" alt=""></p>
<ul>
<li>InnoDB有很多内存块，这些内存块组成了一个大的内存池，负责<ul>
<li>维护所有进程/线程需要访问的多个内部数据结构</li>
<li>缓存磁盘上的数据，方便快速地读取，并且在对磁盘文件的数据进行修改之前在这里缓存</li>
<li>重做日志(redo log)缓冲</li>
</ul>
</li>
</ul>
<p>后台线程的主要作用是负责刷新内存池中的数据，保证缓冲池中的内存缓存的是最近的数据。此外，将已修改的数据文件刷新到磁盘文件，同时保存在数据库发生异常情况下InnoDB能恢复到正常状态。</p>
<h3 id="后台线程"><a href="#后台线程" class="headerlink" title="后台线程"></a><a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-threads.html" target="_blank" rel="external">后台线程</a></h3><p>InnoDB存储引擎是在master thread的线程上几乎实现了所有功能。默认情况下，InnoDB存储引擎的后台线程有7个：</p>
<ul>
<li>IO Thread：4<ul>
<li>Windows平台可以修改：配置文件中的innodb_file_io_threads，默认为4</li>
<li>Linux平台不能调整</li>
</ul>
</li>
<li>master thread：1</li>
<li>锁(lock)监控线程：1</li>
<li>错误监控线程：1</li>
</ul>
<h3 id="查询配置"><a href="#查询配置" class="headerlink" title="查询配置"></a>查询配置</h3><p>当前环境：</p>
<p>版本：5.7.22</p>
<p>平台：MacOS</p>
<ul>
<li>查询InnoDB引擎状态：show engine innodb status\G;`</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">--------</div><div class="line">FILE I/O</div><div class="line">--------</div><div class="line">I/O thread 0 state: waiting for i/o request (insert buffer thread)</div><div class="line">I/O thread 1 state: waiting for i/o request (log thread)</div><div class="line">I/O thread 2 state: waiting for i/o request (read thread)</div><div class="line">I/O thread 3 state: waiting for i/o request (read thread)</div><div class="line">I/O thread 4 state: waiting for i/o request (read thread)</div><div class="line">I/O thread 5 state: waiting for i/o request (read thread)</div><div class="line">I/O thread 6 state: waiting for i/o request (write thread)</div><div class="line">I/O thread 7 state: waiting for i/o request (write thread)</div><div class="line">I/O thread 8 state: waiting for i/o request (write thread)</div><div class="line">I/O thread 9 state: waiting for i/o request (write thread)</div></pre></td></tr></table></figure>
<ul>
<li>查询引擎版本：<code>show variables like &#39;innodb_version&#39;\G</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Variable_name | innodb_version</div><div class="line">Value         | 5.7.22</div></pre></td></tr></table></figure>
<ul>
<li>查询IO线程数量：<code>show variables like &#39;innodb_%io_threads&#39;\G</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">***************************[ 1. row ]***************************</div><div class="line">Variable_name | innodb_read_io_threads</div><div class="line">Value         | 4</div><div class="line">***************************[ 2. row ]***************************</div><div class="line">Variable_name | innodb_write_io_threads</div><div class="line">Value         | 4</div></pre></td></tr></table></figure>
<h3 id="线程调优"><a href="#线程调优" class="headerlink" title="线程调优"></a><a href="https://dev.mysql.com/doc/refman/8.0/en/thread-pool-tuning.html" target="_blank" rel="external">线程调优</a></h3><h4 id="thread-pool-size"><a href="#thread-pool-size" class="headerlink" title="thread_pool_size"></a><code>thread_pool_size</code></h4><blockquote>
<ul>
<li>线程池数量决定最佳性能</li>
<li>在启动时设置</li>
</ul>
</blockquote>
<ul>
<li>InnoDB<ul>
<li>建议值24-36</li>
<li>对于DBT2和Sysbench等工作负载：36左右</li>
<li>对于非常高写的工作负载，最佳设置有时可能更低。</li>
</ul>
</li>
<li>MyISAM<ul>
<li>最佳性能：4-8</li>
<li>较高的值往往会对性能产生轻微负面影响但不会产生显着影响。</li>
</ul>
</li>
</ul>
<h4 id="thread-pool-stall-limit"><a href="#thread-pool-stall-limit" class="headerlink" title="thread_pool_stall_limit"></a><code>thread_pool_stall_limit</code></h4><blockquote>
<ul>
<li>确保服务器不会被完全阻止</li>
<li>运行时可修改</li>
</ul>
</blockquote>
<ul>
<li>上限为6秒，以防止出现死锁服务器的风险</li>
<li>假设服务器执行工作负载，即使服务器加载，99.9％的语句在100ms内完成，其余语句在100ms到2小时之间相当均匀地传播。在这种情况下，将thread_pool_stall_limit设置为10（意味着100ms）是有意义的。</li>
<li>对于主要执行非常简单的语句的服务器，默认值为60ms是可以的。</li>
</ul>
<blockquote>
<p>如果启用了tp_thread_group_stats表，查询确定已停止的已执行语句的比例：<code>SELECT SUM（STALLED_QUERIES_EXECUTED）/ SUM（QUERIES_EXECUTED）
FROM performance_schema.tp_thread_group_stats;</code>这个数字应该尽可能低。要降低语句停顿的可能性，请增加thread_pool_stall_limit的值。</p>
</blockquote>
<p>当一个语句到达时，它在实际开始执行之前可以延迟的最长时间是多少？假设以下条件适用：</p>
<p>在低优先级队列中排队有200个语句。</p>
<p>在高优先级队列中排队有10个语句。</p>
<p>thread_pool_prio_kickup_timer设置为10000（10秒）。</p>
<p>thread_pool_stall_limit设置为100（1秒）。</p>
<p>在最坏的情况下，10个高优先级语句代表10个持续执行很长时间的事务。因此，在最坏的情况下，没有语句将被移动到高优先级队列，因为它总是已经包含等待执行的语句。 10秒后，新语句有资格移动到高优先级队列。但是，在可以移动它之前，它之前的所有语句也必须移动。这可能需要另外2秒，因为每秒最多100个语句被移动到高优先级队列。现在，当语句到达高优先级队列时，可能会有许多长时间运行的语句。在最坏的情况下，每一个都会陷入停滞状态。</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p><a href="http://funwithmysql.blogspot.com/2012/08/mysql-scalability-architecture.html" target="_blank" rel="external">MySQL Scalability Architecture</a></p>
<p><a href="https://www.oreilly.com/library/view/high-performance-mysql/9780596101718/ch01.html" target="_blank" rel="external">High Performance MySQL</a></p>

      
    
    </div>
    
      
  <div class="post-reward">
    <span class="reward-btn" id="reward-btn">点这里</span>
    <div class="reward-wrapper syuanpi" id="reward-wrapper" style="display:none;">
      
      <div class="reward-item reward-alipay">
        <img src="https://wx3.sinaimg.cn/mw690/8c564d2aly1ftkt83thjlj20o60skjzn.jpg">
      </div>
      
    </div>
  </div>


      
    
  </article>
  
    
  <nav class="article-page">
    
      <a href="/MySQL/index.html" id="art-left" class="art-left">
        <span class="next-title">
          <i class="iconfont icon-left"></i>MySQL索引原理
        </span>
      </a>
    
    
      <a href="/es/es_query.html" id="art-right" class="art-right">
        <span class="prev-title"> 
          Elasticsearch查询概述<i class="iconfont icon-right"></i>  
        </span>
      </a>
    
  </nav>

    
  <i id="com-switch" class="iconfont icon-more jumping-in long infinite" style="font-size:24px;display:block;text-align:center;transform:rotate(180deg);"></i>
  <div class="post-comments" id="post-comments" style="display: block;margin: auto 16px;">
    
<!-- Gitment Comments -->
<div id="gitment"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  owner: "super2bai",
  repo: 'comment',
  oauth: {
    client_id: '37f2293730b41dcb5276',
    client_secret: 'dbab4955840d4cbc88f1563be04ab676662194e5',
  },
})
gitment.render('gitment')
</script>

    
    

  </div>


  
  
    
  
  <aside class="post-toc">
    <span class="title" id="toc-switch"><span>文章导航</span></span>
    <div class="toc-inner syuanpi back-1" style="display:none;">
      <li class="title-link"><a href="javascript:;" class="toTop">MySQL概述</a></li>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#体系结构"><span class="toc-text">体系结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InnoDB存储引擎"><span class="toc-text">InnoDB存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#架构"><span class="toc-text">架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#特点"><span class="toc-text">特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#最佳实践"><span class="toc-text">最佳实践</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#架构模型"><span class="toc-text">架构模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#后台线程"><span class="toc-text">后台线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询配置"><span class="toc-text">查询配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线程调优"><span class="toc-text">线程调优</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#thread-pool-size"><span class="toc-text">thread_pool_size</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#thread-pool-stall-limit"><span class="toc-text">thread_pool_stall_limit</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-text">其他</span></a></li></ol>
    </div>
  </aside>



  


        </div>
      </main>

      <footer class="footer syuanpi fadeIn" id="footer">
  <hr>
  <div class="footer-wrapper">
    <div class="left">
      <div class="contact-icon">
    
    
    
    
    
    
    
    
        
            <a href="https://github.com/super2bai" class="iconfont icon-github" title="github"></a>
        
        
        
        
        
        
        
    
</div>
    </div>
    <div class="right">
      <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2017 ~ 2019</span>
        <span>❤</span>
        <span>super2bai</span>
    </div>
    <div class="theme">
        <span>
            动力来源于
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            主题
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    
    <div class="visit_count">
        <i class="iconfont icon-visit"></i>
        <span id="busuanzi_value_site_uv"></span>
        <i class="iconfont icon-people"></i>
        <span id="busuanzi_value_site_pv"></span>
    </div>
    
</div>

    </div>
  </div>
</footer>
    </div>
  </div>
  <script src="/script/lib/jquery/jquery-3.2.1.min.js"></script>


  <script src="/script/lib/lightbox/js/lightbox.min.js"></script>








<script src="/script/src/nlvi.js"></script>

  <script src="/script/scheme/banderole.js"></script>

<script src="/script/bootstarp.js"></script>


<div class="backtop syuanpi melt toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>


  <div class="search" id="search">
    <div class="mask" id="mask"></div>
    <div class="search-wrapper syuanpi">
      <h2 id="search-header" class="syuanpi">找啥？</h2>
      <div class="input">
        <input type="text" id="local-search-input" results="0" name="">
      </div>
      <div id="local-search-result"></div>
    </div>
  </div>


</body>
</html>
