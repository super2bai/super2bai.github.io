<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="stylesheet" href="/style/style.css">
<script>
  var nlviconfig = {
    title: "贰白",
    author: "super2bai",
    baseUrl: "/",
    theme: {
      scheme: "banderole",
      lightbox: true,
      animate: true,
      search: false,
      friends: false,
      lazy: false
    }
  }
</script>




    <link rel="stylesheet" href="/script/lib/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">




    <link rel="icon" href="https://wx4.sinaimg.cn/mw690/8c564d2agy1fq4rsiycy4j202c01wa9v.jpg">




<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98059014-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116557847-1');
</script>





    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="贰白">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />

  <link rel="apple-touch-icon"  sizes="72x72"  href="https://wx4.sinaimg.cn/mw690/8c564d2agy1fq4rsiycy4j202c01wa9v.jpg">
  <link rel="apple-touch-icon-precomposed"  sizes="72x72"  href="https://wx4.sinaimg.cn/mw690/8c564d2agy1fq4rsiycy4j202c01wa9v.jpg">


  <meta name="subtitle" content="苦于探索，全是未知">


  <meta name="description" content="苦于探索，全是未知">



  <meta name="keywords" content="Spring, Nlvi" />

  <title> Spring REST · 贰白 </title>
</head>
<body>
  <div class="progress">
  <div class="progress-inner"></div>
</div>
  
  
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
  <div class="tagcloud-inner">
    <a href="/tags/3D编辑器/" style="font-size: 14px;">3D编辑器</a> <a href="/tags/Docker/" style="font-size: 14px;">Docker</a> <a href="/tags/Dubbo/" style="font-size: 14px;">Dubbo</a> <a href="/tags/Eclipse/" style="font-size: 14px;">Eclipse</a> <a href="/tags/GHPages/" style="font-size: 14px;">GHPages</a> <a href="/tags/IO/" style="font-size: 14px;">IO</a> <a href="/tags/JDK/" style="font-size: 14px;">JDK</a> <a href="/tags/JVM/" style="font-size: 14px;">JVM</a> <a href="/tags/Linux/" style="font-size: 14px;">Linux</a> <a href="/tags/Python/" style="font-size: 14px;">Python</a> <a href="/tags/Spring/" style="font-size: 14px;">Spring</a> <a href="/tags/Tomcat/" style="font-size: 14px;">Tomcat</a> <a href="/tags/Zookeeper/" style="font-size: 14px;">Zookeeper</a> <a href="/tags/jmeter/" style="font-size: 14px;">jmeter</a> <a href="/tags/mac/" style="font-size: 14px;">mac</a> <a href="/tags/walkup/" style="font-size: 14px;">walkup</a> <a href="/tags/分布式/" style="font-size: 14px;">分布式</a> <a href="/tags/工具/" style="font-size: 14px;">工具</a> <a href="/tags/游戏/" style="font-size: 14px;">游戏</a> <a href="/tags/编码/" style="font-size: 14px;">编码</a> <a href="/tags/部署/" style="font-size: 14px;">部署</a> <a href="/tags/问题/" style="font-size: 14px;">问题</a>
  </div>
</div>  
  

  <div class="container">

    <header class="header" id="header">
  <div class="header-wrapper">
    <div class="logo">
  <div class="logo-inner syuanpi tvIn">
    <span><a href="/">贰白</a></span>
    
      <span id="subtitle">苦于探索，全是未知</span>
    
  </div>
</div>
    <nav class="main-nav">
        
  <ul class="main-nav-list syuanpi tvIn">
  
    <li class="menu-item">
      <a href="javascript:;" id="search">
        <span>搜索</span>
        
          <span class="menu-item-label">search</span>
        
      </a>
    </li>
  
  
    
      
    
    <li class="menu-item">
      <a href="/" id="article">
        <span class="base-name">文章</span>
        
          <span class="menu-item-label">article</span>
        
      </a>
    </li>  
  
    
      
    
    <li class="menu-item">
      <a href="/archives" id="archives">
        <span class="base-name">归档</span>
        
          <span class="menu-item-label">archives</span>
        
      </a>
    </li>  
  
    
      
    
    <li class="menu-item">
      <a href="javascript:;" id="tags">
        <span class="base-name">标签</span>
        
          <span class="menu-item-label">tags</span>
        
      </a>
    </li>  
  
    
      
    
    <li class="menu-item">
      <a href="/about" id="about">
        <span class="base-name">关于</span>
        
          <span class="menu-item-label">about</span>
        
      </a>
    </li>  
  
  </ul>
  
</nav>
    
    
  </div>
</header>
<div class="mobile-header">
  <div class="mobile-header-body">
    <div class="mobile-header-list">
      
        
            <div class="mobile-nav-item">
                <a href="/">
                    <span>文章</span>
                    
                        <span class="menu-item-label">article</span>
                    
                </a>
            </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/archives">
                    <span>归档</span>
                    
                        <span class="menu-item-label">archives</span>
                    
                </a>
            </div>
        
      
        
          <div class="mobile-nav-item inner-cloud">
            <div class="mobile-nav-tag">
              <a href="javascript:;" id="mobile-tags">
                <span>标签</span>
                
                    <span class="menu-item-label">tags</span>
                
              </a>
            </div>
            <div class="mobile-nav-tagcloud">
              <div class="mobile-tagcloud-inner">
                <a href="/tags/3D编辑器/" style="font-size: 14px;">3D编辑器</a> <a href="/tags/Docker/" style="font-size: 14px;">Docker</a> <a href="/tags/Dubbo/" style="font-size: 14px;">Dubbo</a> <a href="/tags/Eclipse/" style="font-size: 14px;">Eclipse</a> <a href="/tags/GHPages/" style="font-size: 14px;">GHPages</a> <a href="/tags/IO/" style="font-size: 14px;">IO</a> <a href="/tags/JDK/" style="font-size: 14px;">JDK</a> <a href="/tags/JVM/" style="font-size: 14px;">JVM</a> <a href="/tags/Linux/" style="font-size: 14px;">Linux</a> <a href="/tags/Python/" style="font-size: 14px;">Python</a> <a href="/tags/Spring/" style="font-size: 14px;">Spring</a> <a href="/tags/Tomcat/" style="font-size: 14px;">Tomcat</a> <a href="/tags/Zookeeper/" style="font-size: 14px;">Zookeeper</a> <a href="/tags/jmeter/" style="font-size: 14px;">jmeter</a> <a href="/tags/mac/" style="font-size: 14px;">mac</a> <a href="/tags/walkup/" style="font-size: 14px;">walkup</a> <a href="/tags/分布式/" style="font-size: 14px;">分布式</a> <a href="/tags/工具/" style="font-size: 14px;">工具</a> <a href="/tags/游戏/" style="font-size: 14px;">游戏</a> <a href="/tags/编码/" style="font-size: 14px;">编码</a> <a href="/tags/部署/" style="font-size: 14px;">部署</a> <a href="/tags/问题/" style="font-size: 14px;">问题</a>
              </div>
            </div>
          </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/about">
                    <span>关于</span>
                    
                        <span class="menu-item-label">about</span>
                    
                </a>
            </div>
        
      
    </div>
  </div>
  <div class="mobile-header-nav">
    <div class="mobile-header-item" id="mobile-left">
      <div class="header-menu-item">
        <span class="header-menu-line"></span>
      </div>
    </div>
    <h1 class="mobile-header-title">
      <a href="/">贰白</a>
    </h1>
    <div class="mobile-header-item"></div>
  </div>
</div>
    <div class="container-inner">
      <main class="main" id="main">
        <div class="main-wrapper">
          
    
  
  <article class="
  post
   is_post 
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2017-11-27</span>
          
            
              <span class="post-category"><a href="/categories/Spring/">Spring</a></span>
            
          
          
            
              <aside class="post-tags syuanpi fadeInUpShort back-3">
              
                <a href="/tags/Spring/">Spring</a>
              
              </aside>
            
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          Spring REST
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        <h3 id="理论"><a href="#理论" class="headerlink" title="理论"></a>理论</h3><a id="more"></a>
<p><a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="external">Representational state transfer</a></p>
<blockquote>
<p><strong>Representational state transfer</strong> (<strong>REST</strong>) or <strong>RESTful</strong> <a href="https://en.wikipedia.org/wiki/Web_service" target="_blank" rel="external">web services</a> are a way of providing interoperability between computer systems on the <a href="https://en.wikipedia.org/wiki/Internet" target="_blank" rel="external">Internet</a>. REST-compliant Web services allow requesting systems to access and manipulate textual representations of <a href="https://en.wikipedia.org/wiki/Web_resource" target="_blank" rel="external">Web resources</a> using a uniform and predefined set of <a href="https://en.wikipedia.org/wiki/Stateless_protocol" target="_blank" rel="external">stateless</a> operations. Other forms of Web services exist, which expose their own arbitrary sets of operations such as <a href="https://en.wikipedia.org/wiki/Web_Services_Description_Language" target="_blank" rel="external">WSDL</a> and <a href="https://en.wikipedia.org/wiki/SOAP" target="_blank" rel="external">SOAP</a>.<a href="https://en.wikipedia.org/wiki/Representational_state_transfer#cite_note-1" target="_blank" rel="external">[1]</a> </p>
</blockquote>
<ul>
<li>特性<ul>
<li>性能</li>
<li>伸缩性</li>
<li>简化统一接口</li>
<li>组件的可修改性</li>
<li>通讯的可视性</li>
<li>组件移植性</li>
<li>可靠性</li>
</ul>
</li>
<li>约束<ul>
<li>客户端计算能力薄弱，服务端计算能力较强</li>
<li>无状态<ul>
<li>如果需要持久化状态<ul>
<li>redis</li>
<li>数据库</li>
</ul>
</li>
</ul>
</li>
<li>缓存</li>
<li>分层系统</li>
<li>统一接口</li>
<li>自描述消息</li>
</ul>
</li>
</ul>
<ul>
<li>类型<ul>
<li>GET<ul>
<li>读</li>
</ul>
</li>
<li>PUT<ul>
<li>改</li>
<li>幂等</li>
</ul>
</li>
<li>POST<ul>
<li>增</li>
<li>非幂等</li>
</ul>
</li>
<li>DELETE<ul>
<li>删</li>
<li>幂等</li>
</ul>
</li>
<li>PATCH<ul>
<li>不常用</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p> <strong>幂等</strong>：</p>
<p> 初始状态：0</p>
<p> 修改状态：1 * N</p>
<p> 最终状态：1</p>
<p> <strong>非幂等</strong>：</p>
<p> 初始状态：1</p>
<p> 修改状态：1+1=2</p>
<p> N次修改：1+N=N+1</p>
<p> 最终状态：N+1</p>
<p> 幂等/非幂等 依赖于服务端实现，这种方式是一种契约。</p>
</blockquote>
<ul>
<li>服务端核心接口<ul>
<li>定义相关<ul>
<li>@Controller</li>
<li>RestController</li>
</ul>
</li>
<li>映射相关<ul>
<li>@RequestMapping</li>
<li>@PathVariable</li>
</ul>
</li>
<li>方法相关<ul>
<li>RequestMethod</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><ul>
<li><a href="http://start.spring.io/" target="_blank" rel="external">创建工程</a></li>
<li>创建实体类Person</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.domain;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>创建Controller</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.controller;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.bai.restonwebwebmvc.domain.Person;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> &#125; &#123;<span class="doctag">@link</span> org.springframework.web.bind.annotation.RestController&#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonRestController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/person/&#123;id&#125;"</span>)</div><div class="line">    <span class="comment">//required = false,参数不强制传输</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">person</span><span class="params">(@PathVariable Long id, @RequestParam(required = <span class="keyword">false</span>)</span> String name )</span>&#123;</div><div class="line">        Person person=<span class="keyword">new</span> Person();</div><div class="line">        person.setId(id);</div><div class="line">        person.setName(name);</div><div class="line">        <span class="keyword">return</span> person;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>启动程序(xxxApplication)<ul>
<li>如果IDE用的是<a href="http://www.jetbrains.com/idea/" target="_blank" rel="external">IntelliJ IDEA</a>，可以通过<code>Tools-&gt;Test RESTful Web Service</code>进行访问<code>http://localhost:8080/person/1?name=2bai</code>。</li>
<li>返回：<code>{&quot;id&quot;:1,&quot;name&quot;:&quot;2bai&quot;}</code></li>
</ul>
</li>
</ul>
<h3 id="自描述消息"><a href="#自描述消息" class="headerlink" title="自描述消息"></a>自描述消息</h3><blockquote>
<p>Accept:</p>
<p>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8</p>
</blockquote>
<ul>
<li>第一优先顺序<ul>
<li>text/html</li>
<li>application/xhtml+xml</li>
<li>application/xml</li>
</ul>
</li>
<li>第二优先顺序<ul>
<li>image/webp</li>
<li>image/apng</li>
</ul>
</li>
<li>q=0.9<ul>
<li>权重</li>
<li>浏览器默认设置</li>
<li>可以自行修改</li>
</ul>
</li>
</ul>
<h4 id="按照xml格式返回"><a href="#按照xml格式返回" class="headerlink" title="按照xml格式返回"></a>按照xml格式返回</h4><ul>
<li>添加pom依赖</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--依赖包是通过org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport类中jackson2XmlPresent的className在search.maven.org中搜索得来--&gt;</span></div><div class="line"><span class="comment">&lt;!--search.maven.org -&gt; search -&gt; Advanced Search -&gt; By Classname--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-dataformat-xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>再次访问，会以<code>XML</code>格式返回。</li>
</ul>
<h3 id="问题及解答"><a href="#问题及解答" class="headerlink" title="问题及解答"></a>问题及解答</h3><p>Q：为什么第一次是JSON，后来添加了XML依赖后，又变成了XML</p>
<p>A：Spring Boot应用默认没有增加XML处理器实现，所以最后采用轮询的方式去逐一尝试是否可读(canWrite(POJO))，如果返回true，说明可以序列化改POJO对象，那么Jackson2恰好能处理，那么Jackson输出了。可以查阅源码<code>org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler#sendInternal</code>。</p>
<p>Q：当Accept请求头未被指定时，为什么还是JSON</p>
<p>A：依赖于messageConverters的插入顺序。</p>
<p>Q：converters中的顺序可以修改吗？</p>
<p>A：可以。参考下面实现的扩展之调整顺序。</p>
<h3 id="源码导读"><a href="#源码导读" class="headerlink" title="源码导读"></a>源码导读</h3><h4 id="EnableWebMvc"><a href="#EnableWebMvc" class="headerlink" title="@EnableWebMvc"></a><code>@EnableWebMvc</code></h4><p><code>org.springframework.web.servlet.config.annotation.EnableWebMvc</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</div><div class="line"><span class="meta">@Documented</span></div><div class="line"><span class="meta">@Import</span>(&#123;DelegatingWebMvcConfiguration.class&#125;)</div><div class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableWebMvc &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>org.springframework.web.servlet.config.annotation.DelegatingWebMvcConfiguration</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegatingWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurationSupport</span> </span>&#123;</div><div class="line">  <span class="comment">//ignore</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//List集合：先来先服务</span></div><div class="line"><span class="comment">//所有的HTTP自描述消息处理器均在messageConverters里</span></div><div class="line"><span class="comment">//这个集合会传递到RequestMappingHandlerAdapter类里</span></div><div class="line"><span class="comment">//最终控制写出。</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">addDefaultHttpMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; messageConverters)</span> </span>&#123;</div><div class="line">        StringHttpMessageConverter stringConverter = <span class="keyword">new</span> StringHttpMessageConverter();</div><div class="line">        stringConverter.setWriteAcceptCharset(<span class="keyword">false</span>);</div><div class="line">  		<span class="comment">//开始按顺序添加</span></div><div class="line">		<span class="comment">//debug得出下列顺序,重复添加的为Spring Boot的一个bug</span></div><div class="line"> 		<span class="comment">//0 = &#123;ByteArrayHttpMessageConverter@6489&#125; </span></div><div class="line"> 		<span class="comment">//1 = &#123;StringHttpMessageConverter@6490&#125; </span></div><div class="line"> 		<span class="comment">//2 = &#123;StringHttpMessageConverter@6491&#125; </span></div><div class="line"> 		<span class="comment">//3 = &#123;ResourceHttpMessageConverter@6492&#125; </span></div><div class="line"> 		<span class="comment">//4 = &#123;ResourceRegionHttpMessageConverter@6493&#125; </span></div><div class="line"> 		<span class="comment">//5 = &#123;SourceHttpMessageConverter@6494&#125; </span></div><div class="line"> 		<span class="comment">//6 = &#123;AllEncompassingFormHttpMessageConverter@6495&#125; </span></div><div class="line"> 		<span class="comment">//7 = &#123;MappingJackson2HttpMessageConverter@6166&#125; </span></div><div class="line"> 		<span class="comment">//8 = &#123;MappingJackson2HttpMessageConverter@6240&#125; </span></div><div class="line"> 		<span class="comment">//9 = &#123;MappingJackson2XmlHttpMessageConverter@6247&#125; </span></div><div class="line"> 		<span class="comment">//10 = &#123;MappingJackson2XmlHttpMessageConverter@6258&#125; </span></div><div class="line">  </div><div class="line">        messageConverters.add(<span class="keyword">new</span> ByteArrayHttpMessageConverter());</div><div class="line">        messageConverters.add(stringConverter);</div><div class="line">        messageConverters.add(<span class="keyword">new</span> ResourceHttpMessageConverter());</div><div class="line">        messageConverters.add(<span class="keyword">new</span> ResourceRegionHttpMessageConverter());</div><div class="line">        messageConverters.add(<span class="keyword">new</span> SourceHttpMessageConverter());</div><div class="line">        messageConverters.add(<span class="keyword">new</span> AllEncompassingFormHttpMessageConverter());</div><div class="line">        <span class="keyword">if</span> (romePresent) &#123;</div><div class="line">            messageConverters.add(<span class="keyword">new</span> AtomFeedHttpMessageConverter());</div><div class="line">            messageConverters.add(<span class="keyword">new</span> RssChannelHttpMessageConverter());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Jackson2ObjectMapperBuilder builder;</div><div class="line">  		<span class="comment">//xml</span></div><div class="line">        <span class="keyword">if</span> (jackson2XmlPresent) &#123;</div><div class="line">            builder = Jackson2ObjectMapperBuilder.xml();</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.applicationContext != <span class="keyword">null</span>) &#123;</div><div class="line">                builder.applicationContext(<span class="keyword">this</span>.applicationContext);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            messageConverters.add(<span class="keyword">new</span> MappingJackson2XmlHttpMessageConverter(builder.build()));</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (jaxb2Present) &#123;</div><div class="line">            messageConverters.add(<span class="keyword">new</span> Jaxb2RootElementHttpMessageConverter());</div><div class="line">        &#125;</div><div class="line">		<span class="comment">//json</span></div><div class="line">        <span class="keyword">if</span> (jackson2Present) &#123;</div><div class="line">            builder = Jackson2ObjectMapperBuilder.json();</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.applicationContext != <span class="keyword">null</span>) &#123;</div><div class="line">                builder.applicationContext(<span class="keyword">this</span>.applicationContext);</div><div class="line">            &#125;</div><div class="line">			<span class="comment">//以application/json为例，Spring Boot中默认使用Jackson2序列化方式</span></div><div class="line">			<span class="comment">//媒体类型application/json，处理类为MappingJackson2HttpMessageConverter</span></div><div class="line">            <span class="comment">//提供两类方法：</span></div><div class="line">            <span class="comment">//1.读read*:通过HTTP请求内容转化成对应的Bean</span></div><div class="line">          	<span class="comment">//2.写write*:通过Bean序列化成对应文本内容作为响应内容</span></div><div class="line">            messageConverters.add(<span class="keyword">new</span> MappingJackson2HttpMessageConverter(builder.build()));</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (gsonPresent) &#123;</div><div class="line">            messageConverters.add(<span class="keyword">new</span> GsonHttpMessageConverter());</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (jsonbPresent) &#123;</div><div class="line">            messageConverters.add(<span class="keyword">new</span> JsonbHttpMessageConverter());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (jackson2SmilePresent) &#123;</div><div class="line">            builder = Jackson2ObjectMapperBuilder.smile();</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.applicationContext != <span class="keyword">null</span>) &#123;</div><div class="line">                builder.applicationContext(<span class="keyword">this</span>.applicationContext);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            messageConverters.add(<span class="keyword">new</span> MappingJackson2SmileHttpMessageConverter(builder.build()));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (jackson2CborPresent) &#123;</div><div class="line">            builder = Jackson2ObjectMapperBuilder.cbor();</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.applicationContext != <span class="keyword">null</span>) &#123;</div><div class="line">                builder.applicationContext(<span class="keyword">this</span>.applicationContext);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            messageConverters.add(<span class="keyword">new</span> MappingJackson2CborHttpMessageConverter(builder.build()));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//protected 包内可见/继承类可见</span></div><div class="line"><span class="comment">//final 不允许修改</span></div><div class="line"><span class="keyword">protected</span> <span class="keyword">final</span> List&lt;HttpMessageConverter&lt;?&gt;&gt; getMessageConverters() &#123;</div><div class="line">  <span class="comment">//初始化时如果为空</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.messageConverters == <span class="keyword">null</span>) &#123;</div><div class="line">    <span class="comment">//创建一个并加以扩展</span></div><div class="line">    <span class="keyword">this</span>.messageConverters = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    configureMessageConverters(<span class="keyword">this</span>.messageConverters);</div><div class="line">    <span class="comment">//如果没有扩展</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.messageConverters.isEmpty()) &#123;</div><div class="line">      <span class="comment">//添加默认</span></div><div class="line">      addDefaultHttpMessageConverters(<span class="keyword">this</span>.messageConverters);</div><div class="line">    &#125;</div><div class="line">    extendMessageConverters(<span class="keyword">this</span>.messageConverters);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.messageConverters;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Bean</span></div><div class="line"><span class="function"><span class="keyword">public</span> RequestMappingHandlerAdapter <span class="title">requestMappingHandlerAdapter</span><span class="params">()</span> </span>&#123;</div><div class="line">  RequestMappingHandlerAdapter adapter = createRequestMappingHandlerAdapter();</div><div class="line">  <span class="comment">//内容协调管理器</span></div><div class="line">  <span class="comment">//此类中有一个方法：resolveMediaTypes</span></div><div class="line">  adapter.setContentNegotiationManager(mvcContentNegotiationManager());</div><div class="line">  adapter.setMessageConverters(getMessageConverters());</div><div class="line">  adapter.setWebBindingInitializer(getConfigurableWebBindingInitializer());</div><div class="line">  adapter.setCustomArgumentResolvers(getArgumentResolvers());</div><div class="line">  adapter.setCustomReturnValueHandlers(getReturnValueHandlers());</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (jackson2Present) &#123;</div><div class="line">    adapter.setRequestBodyAdvice(Collections.singletonList(<span class="keyword">new</span> JsonViewRequestBodyAdvice()));</div><div class="line">    adapter.setResponseBodyAdvice(Collections.singletonList(<span class="keyword">new</span> JsonViewResponseBodyAdvice()));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  AsyncSupportConfigurer configurer = <span class="keyword">new</span> AsyncSupportConfigurer();</div><div class="line">  configureAsyncSupport(configurer);</div><div class="line">  <span class="keyword">if</span> (configurer.getTaskExecutor() != <span class="keyword">null</span>) &#123;</div><div class="line">    adapter.setTaskExecutor(configurer.getTaskExecutor());</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (configurer.getTimeout() != <span class="keyword">null</span>) &#123;</div><div class="line">    adapter.setAsyncRequestTimeout(configurer.getTimeout());</div><div class="line">  &#125;</div><div class="line">  adapter.setCallableInterceptors(configurer.getCallableInterceptors());</div><div class="line">  adapter.setDeferredResultInterceptors(configurer.getDeferredResultInterceptors());</div><div class="line"></div><div class="line">  <span class="keyword">return</span> adapter;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>org.springframework.http.converter.json.MappingJackson2HttpMessageConverter#MappingJackson2HttpMessageConverter</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">MappingJackson2HttpMessageConverter</span><span class="params">(ObjectMapper objectMapper)</span> </span>&#123;</div><div class="line">     <span class="keyword">super</span>(objectMapper, <span class="keyword">new</span> MediaType[]&#123;MediaType.APPLICATION_JSON, <span class="keyword">new</span> MediaType(<span class="string">"application"</span>, <span class="string">"*+json"</span>)&#125;);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="扩展自描述消息"><a href="#扩展自描述消息" class="headerlink" title="扩展自描述消息"></a>扩展自描述消息</h3><p><code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport#getMessageConverters</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> <span class="keyword">final</span> List&lt;HttpMessageConverter&lt;?&gt;&gt; getMessageConverters() &#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.messageConverters == <span class="keyword">null</span>) &#123;</div><div class="line">    <span class="keyword">this</span>.messageConverters = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    <span class="comment">//扩展点</span></div><div class="line">    <span class="comment">//有没有自定义配置</span></div><div class="line">    configureMessageConverters(<span class="keyword">this</span>.messageConverters);</div><div class="line">    <span class="comment">//如果没有</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.messageConverters.isEmpty()) &#123;</div><div class="line">      <span class="comment">//加载默认配置</span></div><div class="line">      addDefaultHttpMessageConverters(<span class="keyword">this</span>.messageConverters);</div><div class="line">    &#125;</div><div class="line">    extendMessageConverters(<span class="keyword">this</span>.messageConverters);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.messageConverters;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="一次失败的试验"><a href="#一次失败的试验" class="headerlink" title="一次失败的试验"></a>一次失败的试验</h4><ul>
<li>创建类，继承WebMvcConfigurer</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.config;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Configurable;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</div><div class="line">        converters.add(<span class="keyword">new</span> MappingJackson2HttpMessageConverter());</div><div class="line">        <span class="comment">//converters:[org.springframework.http.converter.json.MappingJackson2HttpMessageConverter@317a118b]</span></div><div class="line">        System.err.println(<span class="string">"converters:"</span>+converters);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>但是，经debug发现，<code>org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport#getMessageConverters</code>方法内，判断<code>this.messageConverters.isEmpty()</code>为true，还是加载了默认配置，这可能是个bug。其实扩展已经加载成功了，可能在某一地方又清空了。</li>
</ul>
<h4 id="这次是成功的"><a href="#这次是成功的" class="headerlink" title="这次是成功的"></a>这次是成功的</h4><h5 id="添加扩展"><a href="#添加扩展" class="headerlink" title="添加扩展"></a>添加扩展</h5><ul>
<li>把默认实现的方法<code>configureMessageConverters</code>换为<code>extendMessageConverters</code></li>
<li>debug发现，在加载默认配置后，自定义配置已经加载成功。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.config;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.xml.MappingJackson2XmlHttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Object object;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</div><div class="line">      	<span class="comment">//加载自定义配置</span></div><div class="line">        converters.add(<span class="keyword">new</span> MappingJackson2XmlHttpMessageConverter());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="调整顺序"><a href="#调整顺序" class="headerlink" title="调整顺序"></a>调整顺序</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.config;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.xml.MappingJackson2XmlHttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Object object;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</div><div class="line">      	<span class="comment">//将自定义配置添加到最前</span></div><div class="line">        converters.set(<span class="number">0</span>,<span class="keyword">new</span> MappingJackson2XmlHttpMessageConverter());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="代码示例-完整版"><a href="#代码示例-完整版" class="headerlink" title="代码示例-完整版"></a>代码示例-完整版</h3><ul>
<li>POJO类—<code>Person</code></li>
<li>扩展处理类—<code>PropertiesPersonHttpMessageConverter</code></li>
<li>配置类—<code>WebMvcConfig</code></li>
<li>Controller—<code>PersonRestController</code></li>
</ul>
<blockquote>
<p> 反序列化：JSON -&gt; MappingJackson2HttpMessageConverter把文本转化为Person对象</p>
<p> 序列化 Person对象 -&gt; <code>PropertiesPersonHttpMessageConverter#write</code>-&gt;Properties文本</p>
</blockquote>
<ul>
<li>如果请求中accept中和produces不一样，controller是不能执行的，会返回HTTP 状态码406</li>
<li>并不一定需要POJO，这么做是简化操作<ul>
<li>JSON -&gt; 反序列化 -&gt; Map -&gt; Properties</li>
<li>增加了操作的复杂度</li>
</ul>
</li>
</ul>
<h4 id="Person"><a href="#Person" class="headerlink" title="Person"></a><code>Person</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.domain;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PropertiesPersonHttpMessageConverter"><a href="#PropertiesPersonHttpMessageConverter" class="headerlink" title="PropertiesPersonHttpMessageConverter"></a><code>PropertiesPersonHttpMessageConverter</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.http.message;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.bai.restonwebwebmvc.domain.Person;</div><div class="line"><span class="keyword">import</span> org.springframework.http.HttpInputMessage;</div><div class="line"><span class="keyword">import</span> org.springframework.http.HttpOutputMessage;</div><div class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.AbstractHttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageNotReadableException;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageNotWritableException;</div><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"><span class="keyword">import</span> java.nio.charset.Charset;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> 2bai</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertiesPersonHttpMessageConverter</span> <span class="keyword">extends</span> <span class="title">AbstractHttpMessageConverter</span>&lt;<span class="title">Person</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PropertiesPersonHttpMessageConverter</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//设置支持的自定义媒体类型</span></div><div class="line">        <span class="keyword">super</span>(MediaType.valueOf(<span class="string">"application/properties+person"</span>));</div><div class="line">        setDefaultCharset(Charset.forName(<span class="string">"UTF-8"</span>));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 是否支持当前POJO类型</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> clazz</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> </span>&#123;</div><div class="line">        <span class="comment">//必须是Person的子类</span></div><div class="line">        <span class="keyword">return</span> clazz.isAssignableFrom(Person.class);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 将HTTP请求中的内容，并将内容转化成响应的POJO对象</span></div><div class="line"><span class="comment">     * properties -&gt; Person</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> clazz</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> inputMessage</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> HttpMessageNotReadableException</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> Person <span class="title">readInternal</span><span class="params">(Class&lt;? extends Person&gt; clazz, HttpInputMessage inputMessage)</span> <span class="keyword">throws</span> IOException, HttpMessageNotReadableException </span>&#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * person.id=1</span></div><div class="line"><span class="comment">         * person.name=2bai</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="comment">//请求体</span></div><div class="line">        InputStream inputStream=inputMessage.getBody();</div><div class="line">        Properties properties=<span class="keyword">new</span> Properties();</div><div class="line"></div><div class="line">        <span class="comment">//将请求中的内容转化成properties</span></div><div class="line">        properties.load(<span class="keyword">new</span> InputStreamReader(inputStream,getDefaultCharset()));</div><div class="line"></div><div class="line">        <span class="comment">//将properties内容转化到Person字段中</span></div><div class="line">        Person person=<span class="keyword">new</span> Person();</div><div class="line">        person.setId(Long.valueOf(properties.getProperty(<span class="string">"person.id"</span>)));</div><div class="line">        person.setName(properties.getProperty(<span class="string">"person.name"</span>));</div><div class="line">        <span class="keyword">return</span> person;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 将POJO内容序列化成文本内容，最终输出到响应中</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> person</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> outputMessage</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> HttpMessageNotWritableException</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">writeInternal</span><span class="params">(Person person, HttpOutputMessage outputMessage)</span> <span class="keyword">throws</span> IOException, HttpMessageNotWritableException </span>&#123;</div><div class="line">        OutputStream outputStream=outputMessage.getBody();</div><div class="line">        Properties properties=<span class="keyword">new</span> Properties();</div><div class="line">        properties.setProperty(<span class="string">"person.id"</span>,String.valueOf(person.getId()));</div><div class="line">        properties.setProperty(<span class="string">"person.name"</span>,person.getName());</div><div class="line">        properties.store(<span class="keyword">new</span> OutputStreamWriter(outputStream,getDefaultCharset()),<span class="string">"Written By Application Server"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="WebMvcConfig"><a href="#WebMvcConfig" class="headerlink" title="WebMvcConfig"></a><code>WebMvcConfig</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.config;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> com.bai.restonwebwebmvc.http.message.PropertiesPersonHttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</div><div class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> 2bai</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span> 2017.11.28</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</div><div class="line">        converters.add(<span class="keyword">new</span> PropertiesPersonHttpMessageConverter());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PersonRestController"><a href="#PersonRestController" class="headerlink" title="PersonRestController"></a><code>PersonRestController</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.bai.restonwebwebmvc.controller;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.bai.restonwebwebmvc.domain.Person;</div><div class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</div><div class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> &#125; &#123;<span class="doctag">@link</span> org.springframework.web.bind.annotation.RestController&#125;</span></div><div class="line"><span class="comment"> * <span class="doctag">@author</span> 2bai</span></div><div class="line"><span class="comment"> * <span class="doctag">@date</span> 2017.11.28</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonRestController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * required = false,参数不强制传输</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/person/&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">person</span><span class="params">(@PathVariable Long id, @RequestParam(required = <span class="keyword">false</span>)</span> String name )</span>&#123;</div><div class="line">        Person person=<span class="keyword">new</span> Person();</div><div class="line">        person.setId(id);</div><div class="line">        person.setName(name);</div><div class="line">        <span class="keyword">return</span> person;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * value    : 路径</span></div><div class="line"><span class="comment">     * consumes ：请求类型 Content-Type</span></div><div class="line"><span class="comment">     * produces ：响应类型 Accept</span></div><div class="line"><span class="comment">     * input :</span></div><div class="line"><span class="comment">     * &#123;</span></div><div class="line"><span class="comment">        "id": 1,</span></div><div class="line"><span class="comment">        "name": "2bai"</span></div><div class="line"><span class="comment">       &#125;</span></div><div class="line"><span class="comment">       output:</span></div><div class="line"><span class="comment">        #Written By Application Server</span></div><div class="line"><span class="comment">        #Tue Nov 28 16:22:48 CST 2017</span></div><div class="line"><span class="comment">        person.name=2bai</span></div><div class="line"><span class="comment">        person.id=1</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> person</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@PostMapping</span>(value=<span class="string">"/person/json/to/properties"</span>,</div><div class="line">            consumes = MediaType.APPLICATION_JSON_UTF8_VALUE,</div><div class="line">            produces = <span class="string">"application/properties+person"</span></div><div class="line">    )</div><div class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">personJsonToProperties</span><span class="params">(@RequestBody Person person)</span></span>&#123;</div><div class="line">        <span class="comment">//@RequestBody读取的是JSON格式</span></div><div class="line">        <span class="comment">//响应的格式是proerties</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> person;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * value    : 路径</span></div><div class="line"><span class="comment">     * consumes ：请求类型 Content-Type</span></div><div class="line"><span class="comment">     * produces ：响应类型 Accept</span></div><div class="line"><span class="comment">     * input :</span></div><div class="line"><span class="comment">     person.name=2bai</span></div><div class="line"><span class="comment">     person.id=1</span></div><div class="line"><span class="comment">     output:</span></div><div class="line"><span class="comment">     &#123;</span></div><div class="line"><span class="comment">     "id": 1,</span></div><div class="line"><span class="comment">     "name": "2bai"</span></div><div class="line"><span class="comment">     &#125;</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> person</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@PostMapping</span>(value=<span class="string">"/person/properties/to/json"</span>,</div><div class="line">            consumes = <span class="string">"application/properties+person"</span>,</div><div class="line">            produces = MediaType.APPLICATION_JSON_UTF8_VALUE</div><div class="line">    )</div><div class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">personPropertiesToJson</span><span class="params">(@RequestBody Person person)</span></span>&#123;</div><div class="line">        <span class="comment">//@RequestBody读取的是proerties</span></div><div class="line">        <span class="comment">//响应的格式是JSON格式</span></div><div class="line">        <span class="keyword">return</span> person;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><ul>
<li>HttpMessageConverter执行逻辑<ul>
<li>读操作<ul>
<li>尝试是否能读取，canRead方法去尝试，如果返回true，下一步执行read</li>
</ul>
</li>
<li>写操作<ul>
<li>尝试是否能写入，canWrite方法去尝试，如果返回true，下一步执行write</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    
    </div>
    
      
  <div class="post-reward">
    <span class="reward-btn" id="reward-btn">赞赏</span>
    <div class="reward-wrapper" id="reward-wrapper" style="display:none;">
      
        
        
      
        
        <div class="reward-item reward-alipay">
          <img src="https://wx3.sinaimg.cn/mw690/8c564d2aly1ftkt83thjlj20o60skjzn.jpg">
        </div>
        
      
    </div>
  </div>

      
    
  </article>
  
    
  <nav class="article-page">
    
      <a href="/Spring/MVC.html" id="art-left" class="art-left">
        <span class="next-title">
          <i class="iconfont icon-left"></i>Spring Web MVC
        </span>
      </a>
    
    
      <a href="/IO/AIO.html" id="art-right" class="art-right">
        <span class="prev-title"> 
          AIO概述<i class="iconfont icon-right"></i>  
        </span>
      </a>
    
  </nav>

    
  <i id="com-switch" class="iconfont icon-more jumping-in long infinite" style="font-size:24px;display:block;text-align:center;transform:rotate(180deg);"></i>
  <div class="post-comments" id="post-comments" style="display: block;margin: auto 16px;">
    
<!-- Gitment Comments -->
<div id="gitment"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  owner: "super2bai",
  repo: 'comment',
  oauth: {
    client_id: '37f2293730b41dcb5276',
    client_secret: 'dbab4955840d4cbc88f1563be04ab676662194e5',
  },
})
gitment.render('gitment')
</script>

    
    

  </div>


  
  
    
  
  <aside class="post-toc">
    <span class="title" id="toc-switch"><span>文章导航</span></span>
    <div class="toc-inner syuanpi back-1" style="display:none;">
      <li class="title-link"><a href="javascript:;" class="toTop">Spring REST</a></li>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#理论"><span class="toc-text">理论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码示例"><span class="toc-text">代码示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自描述消息"><span class="toc-text">自描述消息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#按照xml格式返回"><span class="toc-text">按照xml格式返回</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题及解答"><span class="toc-text">问题及解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#源码导读"><span class="toc-text">源码导读</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EnableWebMvc"><span class="toc-text">@EnableWebMvc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#扩展自描述消息"><span class="toc-text">扩展自描述消息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#一次失败的试验"><span class="toc-text">一次失败的试验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#这次是成功的"><span class="toc-text">这次是成功的</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#添加扩展"><span class="toc-text">添加扩展</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#调整顺序"><span class="toc-text">调整顺序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码示例-完整版"><span class="toc-text">代码示例-完整版</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Person"><span class="toc-text">Person</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PropertiesPersonHttpMessageConverter"><span class="toc-text">PropertiesPersonHttpMessageConverter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebMvcConfig"><span class="toc-text">WebMvcConfig</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PersonRestController"><span class="toc-text">PersonRestController</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其它"><span class="toc-text">其它</span></a></li></ol>
    </div>
  </aside>



  


        </div>
      </main>

      <footer class="footer syuanpi fadeIn" id="footer">
  <hr>
  <div class="footer-wrapper">
    <div class="left">
      <div class="contact-icon">
    
    
    
    
    
    
    
    
        
            <a href="https://github.com/super2bai" class="iconfont icon-github" title="github"></a>
        
        
        
        
        
        
        
    
</div>
    </div>
    <div class="right">
      <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2017 ~ 2018</span>
        <span>❤</span>
        <span>super2bai</span>
    </div>
    <div class="theme">
        <span>
            动力来源于
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            主题
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    
    <div class="visit_count">
        <i class="iconfont icon-visit"></i>
        <span id="busuanzi_value_site_uv"></span>
        <i class="iconfont icon-people"></i>
        <span id="busuanzi_value_site_pv"></span>
    </div>
    
</div>

    </div>
  </div>
</footer>
    </div>
  </div>
  <script src="/script/lib/jquery/jquery-3.2.1.min.js"></script>


  <script src="/script/lib/lightbox/js/lightbox.min.js"></script>



  <script src="https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({tex2jax: {inlineMath: [["$","$"], ["\\(","\\)"]]}});</script>






<script src="/script/src/nlvi.js"></script>

  <script src="/script/scheme/banderole.js"></script>

<script src="/script/bootstarp.js"></script>


<div class="backtop syuanpi melt toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>



</body>
</html>
